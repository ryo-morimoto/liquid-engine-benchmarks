{% comment %}
Stress test: 20+ chained filters
Tests the template engine's filter chain performance
{% endcomment %}

{% comment %} String filter chain - 20+ filters {% endcomment %}
{{ text
  | strip
  | downcase
  | capitalize
  | prepend: "Title: "
  | append: " - End"
  | replace: "a", "A"
  | replace: "e", "E"
  | replace: "i", "I"
  | replace: "o", "O"
  | replace: "u", "U"
  | upcase
  | truncate: 100
  | strip
  | split: " "
  | first
  | append: "..."
  | prepend: "["
  | append: "]"
  | upcase
  | strip
}}

{% comment %} Array filter chain {% endcomment %}
{% assign processed_items = items
  | sort: "value"
  | reverse
  | uniq
  | compact
  | first
%}
{{ processed_items.name }}

{% comment %} Multiple numeric operations {% endcomment %}
{% assign num = base_number
  | plus: 100
  | minus: 50
  | times: 2
  | divided_by: 4
  | plus: 10
  | minus: 5
  | times: 3
  | divided_by: 2
  | round
  | plus: 1
  | minus: 1
  | times: 10
  | divided_by: 5
  | plus: 25
  | minus: 15
  | times: 4
  | divided_by: 8
  | round: 2
  | plus: 0.5
  | minus: 0.25
%}
Result: {{ num }}

{% comment %} Complex string transformations on each product {% endcomment %}
{% for product in products %}
  <div class="product-row">
    <span class="title">
      {{ product.title
        | strip
        | downcase
        | capitalize
        | truncate: 30
        | prepend: "â€¢ "
      }}
    </span>
    <span class="price">
      {{ product.price
        | divided_by: 100
        | round: 2
        | prepend: "$"
        | append: " USD"
      }}
    </span>
    <span class="description">
      {{ product.description
        | strip_html
        | strip_newlines
        | truncate: 50
        | escape
        | replace: ".", "..."
        | downcase
        | capitalize
      }}
    </span>
  </div>
{% endfor %}

{% comment %} Date-like string manipulation {% endcomment %}
{% assign date_string = "2024-01-15T10:30:00Z"
  | split: "T"
  | first
  | split: "-"
  | reverse
  | join: "/"
  | prepend: "Date: "
  | append: " (formatted)"
%}
{{ date_string }}

{% comment %} URL-like transformations {% endcomment %}
{% assign url = "/products/sample product name"
  | downcase
  | replace: " ", "-"
  | replace: "--", "-"
  | prepend: "https://example.com"
  | append: ".html"
  | split: "/"
  | last
  | split: "."
  | first
  | upcase
  | truncate: 20
%}
Slug: {{ url }}
